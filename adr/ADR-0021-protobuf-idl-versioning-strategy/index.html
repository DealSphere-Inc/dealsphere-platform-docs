
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.17">
    
    
      
        <title>ADR-0021: Protobuf IDL Versioning Strategy - DealSphere Docs</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7e37652d.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#adr-0021-protobuf-idl-versioning-strategy" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="DealSphere Docs" class="md-header__button md-logo" aria-label="DealSphere Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            DealSphere Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              ADR-0021: Protobuf IDL Versioning Strategy
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/DealSphere-Inc/dealsphere-docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="DealSphere Docs" class="md-nav__button md-logo" aria-label="DealSphere Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    DealSphere Docs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/DealSphere-Inc/dealsphere-docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../release-process.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Release Process
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    ADRs
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            ADRs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ADR-0001.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ADR-0001
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Technical
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Technical
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tech/phase-1-technical-plan/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Technical Plan
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#context" class="md-nav__link">
    <span class="md-ellipsis">
      Context
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#decision" class="md-nav__link">
    <span class="md-ellipsis">
      Decision
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rationale" class="md-nav__link">
    <span class="md-ellipsis">
      Rationale
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Rationale">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#why-a-protobuf-idl-versioning-strategy" class="md-nav__link">
    <span class="md-ellipsis">
      Why a Protobuf IDL Versioning Strategy?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#future-direction" class="md-nav__link">
    <span class="md-ellipsis">
      Future Direction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deferred-alternatives" class="md-nav__link">
    <span class="md-ellipsis">
      Deferred Alternatives
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rejected-alternatives" class="md-nav__link">
    <span class="md-ellipsis">
      Rejected Alternatives
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#consequences" class="md-nav__link">
    <span class="md-ellipsis">
      Consequences
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rollout-plan" class="md-nav__link">
    <span class="md-ellipsis">
      Rollout Plan
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#revisit-trigger-and-target-sprint" class="md-nav__link">
    <span class="md-ellipsis">
      Revisit Trigger and Target Sprint
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#guardrails" class="md-nav__link">
    <span class="md-ellipsis">
      Guardrails
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Guardrails">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#must" class="md-nav__link">
    <span class="md-ellipsis">
      Must
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#should" class="md-nav__link">
    <span class="md-ellipsis">
      Should
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wont" class="md-nav__link">
    <span class="md-ellipsis">
      Won’t
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#approvals" class="md-nav__link">
    <span class="md-ellipsis">
      Approvals
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#links" class="md-nav__link">
    <span class="md-ellipsis">
      Links
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="adr-0021-protobuf-idl-versioning-strategy">ADR-0021: Protobuf IDL Versioning Strategy</h1>
<p><strong>Author:</strong> @MysterTech<br />
<strong>Status:</strong> Accepted<br />
<strong>Date:</strong> 2025-08-13<br />
<strong>Deciders:</strong> @MysterTech<br />
<strong>Technical Story:</strong> [optional link to ticket/issue]<br />
<strong>Tags:</strong> contracts, protobuf, versioning</p>
<h2 id="context">Context</h2>
<p>As we launch a greenfield microservices platform, all service-to-service communication will use Protocol Buffers (protobuf) to define structured payloads over HTTP. The key issue driving this decision is the need to establish clear, consistent versioning and compatibility practices for protobuf contracts from the outset. Without disciplined guidelines, rapid team growth and parallel development could lead to accidental breaking changes or developer friction as services evolve.</p>
<p>Although we do not need to migrate or preserve legacy data, it is critical to set strong IDL (Interface Definition Language) management foundations so every future schema change remains safe, transparent, and well-governed. This proactive approach will enable autonomous teams to iterate quickly while maintaining reliability and cross-service compatibility as new features and services are added.</p>
<h2 id="decision">Decision</h2>
<p>Adopt a transport-agnostic protobuf IDL versioning strategy that mandates backward-compatible evolution by default, explicit deprecation timelines, and CI-enforced compatibility checks for all schema changes used over HTTP (and any other future transports).</p>
<h2 id="rationale">Rationale</h2>
<h3 id="why-a-protobuf-idl-versioning-strategy">Why a Protobuf IDL Versioning Strategy?</h3>
<p><strong>Prevent Breaking Changes Early</strong>
- Even in a greenfield, multiple teams iterating in parallel can unintentionally introduce breaking schema changes.
- Clear evolution rules (additive-first, reserved fields/tags, explicit deprecations) protect downstream consumers and reduce coordination overhead.</p>
<p><strong>Strong Contracts with HTTP</strong>
- Protobuf provides compact, strongly-typed contracts for HTTP payloads, enabling efficient S2S calls without coupling to gRPC semantics.
- A transport-agnostic IDL lets us evolve payloads while keeping HTTP concerns (status codes, headers, error envelopes) cleanly separated.</p>
<p><strong>Autonomy with Governance</strong>
- Teams can iterate independently when contract rules, compatibility checks, and review workflows are standardized.
- Automated CI compatibility validation (backward/forward) reduces review burden and catches issues before merge.</p>
<p><strong>Observability and Debuggability</strong>
- Consistent field evolution and error envelope conventions improve logs, traces, and on-call diagnostics.
- Predictable schema changes make it easier to analyze incidents and roll back safely.</p>
<h3 id="future-direction">Future Direction</h3>
<p>While HTTP with protobuf is our standard for synchronous service-to-service communication today, we anticipate migrating to a message broker architecture (e.g., Kafka) for asynchronous/event-driven workflows as platform scale and complexity grows. Protobuf contracts and disciplined versioning will remain foundational, ensuring a smooth transition to Kafka or similar brokers and unified schema evolution across both synchronous (HTTP) and asynchronous (message broker) channels.</p>
<h3 id="deferred-alternatives">Deferred Alternatives</h3>
<p><strong>Schema Registries and Central Brokers</strong>
- Reason for deferral: Adds operational complexity not required for HTTP payloads at current scale.
- Revisit when: Cross-language schema discovery, runtime validation, or large-scale event streaming warrants registry-backed workflows.</p>
<p><strong>Full API Contract Federation (beyond protobuf)</strong>
- Reason for deferral: Federation is more relevant to external API composition; internal S2S needs are met with protobuf + HTTP.
- Revisit when: Internal query composition across domains becomes a core requirement.</p>
<h3 id="rejected-alternatives">Rejected Alternatives</h3>
<p><strong>Ad-hoc JSON-only Contracts</strong>
- Reason for rejection: Lacks strong typing, increases payload size, and raises risk of silent breaking changes.
- Reconsider only if: A service is strictly external-facing and human-readability/debuggability outweighs efficiency (not our S2S default).</p>
<p><strong>gRPC-Coupled Evolution Rules</strong>
- Reason for rejection: Ties contract evolution to a transport we are not using for S2S; we need transport-agnostic guidance focused on HTTP payloads.
- Reconsider only if: We adopt gRPC broadly for S2S in the future and need its RPC-specific semantics.</p>
<h2 id="consequences">Consequences</h2>
<p><strong>Positive</strong>
- Consistent, strongly-typed contracts reduce accidental breaking changes and improve cross-team velocity.
- Smaller, faster payloads with protobuf improve internal latency and bandwidth efficiency over HTTP.
- Transport-agnostic IDL keeps options open for future Kafka/event-driven adoption with minimal rework.</p>
<p><strong>Negative</strong>
- Additional governance overhead: PR reviews, CI compatibility checks, and documentation discipline are required.
- Binary payloads make ad-hoc debugging harder than JSON; teams must rely on tooling and generated stubs.
- Strict compatibility rules can slow down radical refactors without planned deprecation windows.</p>
<p><strong>Mitigation Strategies</strong>
- Provide tooling (pre-commit hooks, CI jobs) for linting, backward/forward compatibility checks, and doc generation.
- Support content negotiation for JSON in dev/debug scenarios while defaulting to protobuf for S2S.
- Establish clear deprecation policies, change logs, and reserved field/tag practices to enable safe evolution.</p>
<h2 id="rollout-plan">Rollout Plan</h2>
<p><strong>Baseline Setup:</strong>
- Establish a central, version-controlled repository for all protobuf contracts.
- Implement mandatory pull request reviews and CI jobs for schema linting and compatibility checks.
- Publish guidelines covering field/tags discipline, versioning, deprecation, and changelogs.</p>
<p><strong>Phase 1 Adoption:</strong>
- Require all new services to source protobuf contracts from the central repo for HTTP payloads.
- Integrate automated CI enforcement for compatibility, additive changes, and reserved field checks.
- Document contract evolution and maintain history in the repo changelog.</p>
<p><strong>Continuous Improvement:</strong>
- Periodically review contract evolution incidents and update guidelines as needed.
- Expand integration with automated contract documentation and monitoring dashboards.
- Revisit broker/event-driven adoption and schema registry needs as the number and complexity of asynchronous workflows grow.</p>
<p><strong>Future Broker Integration:</strong>
- As event-driven patterns and Kafka adoption increase, plan for seamless schema management extension to broker channels—maintaining central repo discipline and considering schema registry adoption when justified by scale or polyglot scenarios.</p>
<h2 id="revisit-trigger-and-target-sprint">Revisit Trigger and Target Sprint</h2>
<p><strong>Revisit Trigger:</strong><br />
- Compatibility checks become insufficient for real-world schemas, causing incidents.<br />
- Significant ecosystem/tooling improvements suggest an alternative IDL is materially better.<br />
- Widespread need for schema features protobuf cannot address cleanly.</p>
<p><strong>Target Sprint:</strong><br />
- Sprint 1 (baseline enforcement and documentation as part of Phase 1 foundations).</p>
<h2 id="guardrails">Guardrails</h2>
<h3 id="must">Must</h3>
<ul>
<li>Define and manage all protobuf schemas in a central, version-controlled repository with mandatory PR reviews and CI compatibility checks.</li>
<li>Use unique, never-reused field numbers; only add new optional fields or explicitly deprecate old ones.</li>
<li>Maintain backward compatibility for all contract changes; deprecations must be documented with clear communication and established timelines.</li>
<li>Enforce CI checks to lint, validate, and prevent tag reuse or breaking changes on every schema update.</li>
<li>Contracts for both HTTP and future broker transports (e.g., Kafka) must follow the same versioning discipline and central governance.</li>
</ul>
<h3 id="should">Should</h3>
<ul>
<li>Prefer additive changes; avoid renaming fields and instead add new ones while deprecating old.</li>
<li>Centralize common types and follow consistent naming and package conventions across all services.</li>
<li>Provide JSON encoding for dev/debug scenarios but default to protobuf for service-to-service payloads.</li>
<li>Review contract evolution incidents periodically and update guidelines as needed.</li>
</ul>
<h3 id="wont">Won’t</h3>
<ul>
<li>Tie versioning, evolution, or schema governance to any single transport protocol (e.g., avoid gRPC-specific semantics).</li>
<li>Reuse field numbers, remove fields without documentation or migration path, or bypass central schema repository processes.</li>
<li>Merge business logic into serialization or transport layers.</li>
</ul>
<h2 id="approvals">Approvals</h2>
<table>
<thead>
<tr>
<th>Review</th>
<th>Reviewer</th>
<th>Date (YYYY-MM-DD)</th>
<th>Status</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td>Architectural Review</td>
<td>@MysterTech</td>
<td>2025-08-14</td>
<td>Approved</td>
<td></td>
</tr>
<tr>
<td>Security Review</td>
<td>@MysterTech</td>
<td>2025-08-14</td>
<td>Approved</td>
<td></td>
</tr>
<tr>
<td>SRE Review</td>
<td>@MysterTech</td>
<td>2025-08-14</td>
<td>Approved</td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="links">Links</h2>
<ul>
<li><strong>Technology Landscape:</strong> ../tech/technology-landscape.md#phase-1-technical-plan  </li>
<li>
<p><strong>Sprint Plan:</strong> ../tech/sprint-plan-phase-1.md#phase-1-sprint-plan</p>
</li>
<li>
<p><strong>Related ADRs</strong></p>
</li>
<li><a href="../ADR-0001-java-17-runtime/">ADR-0001: Java 17 as Language/Runtime</a></li>
<li><a href="../ADR-0002-microservices-architecture/">ADR-0002: Microservices Architecture</a></li>
<li><a href="../ADR-0003-http-inter-service-communication/">ADR-0003: HTTP for Inter-Service Communication</a></li>
<li><a href="../ADR-0004-graphql-apollo-gateway-external-api/">ADR-0004: GraphQL via Apollo Gateway for External API</a></li>
<li><a href="../ADR-0005-r3-corda-5-dlt-platform/">ADR-0005: R3 Corda 5 as DLT Platform</a></li>
<li><a href="../ADR-0006-docker-compose-phase1-orchestration/">ADR-0006: Docker Compose for Phase 1 Orchestration</a></li>
<li><a href="../ADR-0007-service-framework-defaults/">ADR-0007: Service Framework Default Selection</a></li>
<li><a href="../ADR-0008-database-selection/">ADR-0008: Database Selection</a></li>
<li><a href="../ADR-0011-authorization-strategy/">ADR-0011: Authorization Strategy</a></li>
<li><a href="../ADR-0012-secrets-management/">ADR-0012: Secrets Management</a></li>
<li><a href="../ADR-0013-observability-stack/">ADR-0013: Observability Stack</a></li>
<li><a href="../ADR-0022-connection-pool-budget-management/">ADR-0022: Connection Pool Budget Management</a></li>
<li><a href="../ADR-0023-persisted-queries-and-batching/">ADR-0023: Persisted Queries and Batching</a></li>
<li><a href="../ADR-0025-event-streaming-platform/">ADR-0025: Event Streaming Platform</a></li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.92b07e13.min.js"></script>
      
    
  </body>
</html>